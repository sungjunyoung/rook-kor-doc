<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rook (Ceph) Korean Documentation</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="indroduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="rook.html"><strong aria-hidden="true">1.</strong> Rook</a></li><li class="chapter-item expanded "><a href="quickstart.html"><strong aria-hidden="true">2.</strong> Quickstart</a></li><li class="chapter-item expanded "><a href="prerequisites/prerequisites.html"><strong aria-hidden="true">3.</strong> Prerequisites</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="prerequisites/authenticated_registries.html"><strong aria-hidden="true">3.1.</strong> Authenticated Registries</a></li><li class="chapter-item expanded "><a href="prerequisites/pod_security_policies.html"><strong aria-hidden="true">3.2.</strong> Pod Security Policies</a></li></ol></li><li class="chapter-item expanded "><a href="ceph_storage/ceph_storage.html"><strong aria-hidden="true">4.</strong> Ceph Storage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ceph_storage/admission_controller.html"><strong aria-hidden="true">4.1.</strong> Admission Controller</a></li><li class="chapter-item expanded "><a href="ceph_storage/examples.html"><strong aria-hidden="true">4.2.</strong> Examples</a></li><li class="chapter-item expanded "><a href="ceph_storage/openshift.html"><strong aria-hidden="true">4.3.</strong> Openshift</a></li><li class="chapter-item expanded "><a href="ceph_storage/block_storage.html"><strong aria-hidden="true">4.4.</strong> Block Storage</a></li><li class="chapter-item expanded "><a href="ceph_storage/object_storage.html"><strong aria-hidden="true">4.5.</strong> Object Storage</a></li><li class="chapter-item expanded "><a href="ceph_storage/shared_filesystem.html"><strong aria-hidden="true">4.6.</strong> Shared Filesystem</a></li><li class="chapter-item expanded "><a href="ceph_storage/ceph_dashboard.html"><strong aria-hidden="true">4.7.</strong> Ceph Dashboard</a></li><li class="chapter-item expanded "><a href="ceph_storage/prometheus_monitoring.html"><strong aria-hidden="true">4.8.</strong> Prometheus Monitoring</a></li><li class="chapter-item expanded "><a href="ceph_storage/cluster_crd.html"><strong aria-hidden="true">4.9.</strong> Cluster CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/block_pool_crd.html"><strong aria-hidden="true">4.10.</strong> Block Pool CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/object_store_crd.html"><strong aria-hidden="true">4.11.</strong> Object Store CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/object_multisite_crds.html"><strong aria-hidden="true">4.12.</strong> Object Multisite CRDs</a></li><li class="chapter-item expanded "><a href="ceph_storage/object_bucket_claim.html"><strong aria-hidden="true">4.13.</strong> Object Bucket Claim</a></li><li class="chapter-item expanded "><a href="ceph_storage/object_store_user_crd.html"><strong aria-hidden="true">4.14.</strong> Object Store User CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/bucket_notifications.html"><strong aria-hidden="true">4.15.</strong> Bucket Notifications</a></li><li class="chapter-item expanded "><a href="ceph_storage/shared_filesstem_crd.html"><strong aria-hidden="true">4.16.</strong> Shared Filesystem CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/nfs_crd.html"><strong aria-hidden="true">4.17.</strong> NFS CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/ceph_csi.html"><strong aria-hidden="true">4.18.</strong> Ceph CSI</a></li><li class="chapter-item expanded "><a href="ceph_storage/rbd_mirroring.html"><strong aria-hidden="true">4.19.</strong> RBD Mirroring</a></li><li class="chapter-item expanded "><a href="ceph_storage/failover_and_failback.html"><strong aria-hidden="true">4.20.</strong> Failover and Failback</a></li><li class="chapter-item expanded "><a href="ceph_storage/snapshots.html"><strong aria-hidden="true">4.21.</strong> Snapshots</a></li><li class="chapter-item expanded "><a href="ceph_storage/volume_clone.html"><strong aria-hidden="true">4.22.</strong> Volume clone</a></li><li class="chapter-item expanded "><a href="ceph_storage/client_crd.html"><strong aria-hidden="true">4.23.</strong> Client CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/rbdmirror_crd.html"><strong aria-hidden="true">4.24.</strong> RBDMirror CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/filesystemmirror_crd.html"><strong aria-hidden="true">4.25.</strong> FilesystemMirror CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/subvolumegroup_crd.html"><strong aria-hidden="true">4.26.</strong> SubVolumeGroup CRD</a></li><li class="chapter-item expanded "><a href="ceph_storage/key_management_system.html"><strong aria-hidden="true">4.27.</strong> Key Management System</a></li><li class="chapter-item expanded "><a href="ceph_storage/configuration.html"><strong aria-hidden="true">4.28.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="ceph_storage/upgrades.html"><strong aria-hidden="true">4.29.</strong> Upgrades</a></li><li class="chapter-item expanded "><a href="ceph_storage/cleanup.html"><strong aria-hidden="true">4.30.</strong> Cleanup</a></li></ol></li><li class="chapter-item expanded "><a href="helm_charts/helm_charts.html"><strong aria-hidden="true">5.</strong> Helm Charts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="helm_charts/ceph_operator.html"><strong aria-hidden="true">5.1.</strong> Ceph Operator</a></li><li class="chapter-item expanded "><a href="helm_charts/ceph_cluster.html"><strong aria-hidden="true">5.2.</strong> Ceph Cluster</a></li></ol></li><li class="chapter-item expanded "><a href="common_issues.html"><strong aria-hidden="true">6.</strong> Common Issues</a></li><li class="chapter-item expanded "><a href="ceph_tools/ceph_tools.html"><strong aria-hidden="true">7.</strong> Ceph Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ceph_tools/toolbox.html"><strong aria-hidden="true">7.1.</strong> Toolbox</a></li><li class="chapter-item expanded "><a href="ceph_tools/common_issues.html"><strong aria-hidden="true">7.2.</strong> Common Issues</a></li><li class="chapter-item expanded "><a href="ceph_tools/csi_common_issues.html"><strong aria-hidden="true">7.3.</strong> CSI Common Issues</a></li><li class="chapter-item expanded "><a href="ceph_tools/monitor_health.html"><strong aria-hidden="true">7.4.</strong> Monitor Health</a></li><li class="chapter-item expanded "><a href="ceph_tools/osd_management.html"><strong aria-hidden="true">7.5.</strong> OSD Management</a></li><li class="chapter-item expanded "><a href="ceph_tools/direct_tools.html"><strong aria-hidden="true">7.6.</strong> Direct Tools</a></li><li class="chapter-item expanded "><a href="ceph_tools/advanced_configuration.html"><strong aria-hidden="true">7.7.</strong> Advanced Configuration</a></li><li class="chapter-item expanded "><a href="ceph_tools/openshift_common_issues.html"><strong aria-hidden="true">7.8.</strong> Openshift Common Issues</a></li><li class="chapter-item expanded "><a href="ceph_tools/disaster_recovery.html"><strong aria-hidden="true">7.9.</strong> Disaster Recovery</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rook (Ceph) Korean Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>개인 공부를 위한 목적으로 작성된 문서입니다. 잘못된 번역이 있을 수 있으며 Openshift 및 일부 작성자에게 불필요한 문서는 번역되어 있지 않습니다.</p>
<blockquote>
<p>PR 은 언제든 환영합니다 :)</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rook"><a class="header" href="#rook">Rook</a></h1>
<p>Rook 은 플랫폼, 프레임워크를 제공하고, cloud-native 환경과 통합된 다양한 스토리지를 지원하는 오픈소스 <strong>cloud native 스토리지 오케스트레이터</strong> 입니다.</p>
<p>Rook 은 배포, 부트스트래핑, 설정, 프로비저닝, 스케일링, 업그레이드, 마이그레이션, 재난 복구, 모니터링, 리소스 관리를 자동화하여 스토리지 소프트웨어를 self-managing, self-scailing, self-healing 스토리지 서비스로 바꿔줍니다. Rook 은 cloud-native 컨테이너 관리, 스케줄링, 오케스트레이션 플랫폼 아래에서 그 역할을 수행합니다.</p>
<p>Rook 은 (Kubernetes 의) 확장 기능을 사용하여 cloud native 환경에 통합됩니다. 그리고, 스케줄링, 라이프사이클 관리, 리소스 관리, 보안, 모니터링, 그리고 유저 경험에 있어 seamless 한 경험을 제공합니.</p>
<p>Ceph operator 는 프로덕션 스토리지 플랫폼을 몇년간 제공하며 2018년 12월에 Rook v0.9 가 릴리즈되며 안정화되었습니다.</p>
<h2 id="quick-start-guide"><a class="header" href="#quick-start-guide">Quick Start Guide</a></h2>
<p>몇 가지의 <code>kubectl</code> 커맨드를 사용하여 Ceph 을 클러스터에 구성할 수 있습니다. <a href="./quickstart.html">QuickStart</a> 가이드를 참고하여 Ceph operator 를 시작하세요!</p>
<h2 id="designs"><a class="header" href="#designs">Designs</a></h2>
<p><a href="https://docs.ceph.com/en/latest/">Ceph</a> 은 블록 스토리지, 오브젝트 스토리지, 공유 파일시스템에 프로덕션 레벨로 수년간 안정화된 확장성있는 분산 스토리지 솔루션입니다. <a href="https://rook.io/docs/rook/v1.8/ceph-storage.html">Ceph overview</a> 를 참고하세요.</p>
<p>자세한 디자인 문서는, <a href="https://github.com/rook/rook/tree/master/design">design docs</a> 를 참고하세요.</p>
<h2 id="need-help-be-sure-to-join-the-rook-slack"><a class="header" href="#need-help-be-sure-to-join-the-rook-slack">Need help? Be sure to join the Rook Slack</a></h2>
<p>질문이 있다면, 주저하지 말고 <a href="https://rook-io.slack.com/">Slack channel</a> 에 문의하세요. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quickstart"><a class="header" href="#quickstart">Quickstart</a></h1>
<p>Rook 에 오신 것을 환영합니다! 여러분의 쿠버네티스 클러스터에 확장 가능하고 견고한 Ceph 스토리지를 <strong>cloud-native 스토리지 오케스트레이터 플랫폼</strong> 을 사용하여 설치하는 최상의 경험을 제공하길 희망합니다.</p>
<p>질문이 있다면 주저하지 말고 <a href="https://rook-io.slack.com/">Slack channel</a> 에 문의하세요. </p>
<p>이 가이드는 Ceph 클러스터의 기본 셋업 및 여러분의 클러스터에서 Pod 들이 블록, 오브젝트, 파일 스토리지를 사용할 수 있도록 도와줄 것입니다.</p>
<p><strong>Rook 를 테스트 하기 위해서는 항상 VM 을 사용하세요. 호스트 시스템의 로컬 디바이스가 실수로 사용되지 않도록 해야 합니다.</strong></p>
<h2 id="minimum-version"><a class="header" href="#minimum-version">Minimum Version</a></h2>
<p>Rook 지원을 위해서 쿠버네티스 v1.16 혹은 그 이상이 필요합니다.</p>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p><a href="./prerequisites.html">Prerequisites</a> 에 따라 쿠버네티스 클러스터가 <code>Rook</code> 을 설치하기 위해 준비가 되었는지 확인해야 합니다.</p>
<p>Ceph 스토리지 클러스터를 설정하기 위해서, 아래 중 적어도 하나의 스토리지 옵션이 필요합니다:</p>
<ul>
<li>Raw 디바이스 (파티션이 없고, 포맷되어있지 않아야함)
<ul>
<li>이 요구사항은 호스트에 <code>lvm2</code> 가 설치되어 있어야 합니다. 이 디펜던시를 피하기 위해서는, 디스크에 single full-disk 파티션 (아래 참고) 을 만들어야 합니다.</li>
</ul>
</li>
<li>Raw 파티션 (포맷되어 있지 않아야 함)</li>
<li>StorageClass 로 PersistentVolume 이 <code>block</code> 모드로 생성 가능해야함</li>
</ul>
<h2 id="tldr"><a class="header" href="#tldr">TL;DR</a></h2>
<p>간단한 Rook 클러스터는 아래와 같이 kubectl 커맨드와 <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples">example manifests</a> 로 만들 수 있습니다.</p>
<pre><code class="language-sh">$ git clone --single-branch --branch v1.8.5 https://github.com/rook/rook.git
cd rook/deploy/examples
kubectl create -f crds.yaml -f common.yaml -f operator.yaml
kubectl create -f cluster.yaml
</code></pre>
<p>클러스터가 Running 상태가 되면, <a href="quickstart.html#storage">블록, 오브젝트 혹은 파일</a> 스토리지를 여러분의 어플리케이션에서 사용할 수 있습니다.</p>
<h2 id="deploy-the-rook-operator"><a class="header" href="#deploy-the-rook-operator">Deploy the Rook Operator</a></h2>
<p>첫번째 스텝은 Rook operator 를 배포하는 것입니다. 원하는 Rook 릴리즈 버전의 <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples">example yaml files</a> 을 사용하는지 확인해야 합니다. 더 많은 옵션은, <a href="/ceph_storage/examples.html">examples 문서</a> 를 확인하세요.</p>
<pre><code class="language-sh">cd deploy/examples
kubectl create -f crds.yaml -f common.yaml -f operator.yaml

# verify the rook-ceph-operator is in the `Running` state before proceeding
kubectl -n rook-ceph get pod
</code></pre>
<p><a href="/helm_charts/ceph_operator.html">Rook Helm Chart</a> 로 배포할 수도 있습니다.</p>
<p>프로덕션에 배포하기 전에 고려해야 할 사항이 몇가지 존재합니다.</p>
<ol>
<li>디폴트로 비활성화 되어 있는 Rook 기능들을 활성화하기를 원하다면, 추가 설정을 위해 <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/operator.yaml">operator.yaml</a> 을 확인하세요.
<ol>
<li>Device discovery: <code>ROOK_ENABLE_DISCOVERY_DAEMON</code> 설정이 활성화 되어 있다면, 일반적으로 베어메탈 클러스터에서 사용되어 신규 디바이스를 감지하고 설정합니다.</li>
<li>Node affinity and tolerations: CSI 드라이버는 기본적으로 어떤 노드에나 스케줄링 될 수 있습니다. CSI 드라이버 affinity 를 지정하기 위한 여러 설정들이 존재합니다.</li>
</ol>
</li>
</ol>
<p><code>rook-ceph</code> 네임스페이스 외에 다른 네임스페이스에 설치하기 원하다면, <a href="/ceph_tools/advanced_configuration.html#using-alternate-namespaces">Ceph advanced configuration 섹션</a> 을 참고하세요.</p>
<h2 id="cluster-environments"><a class="header" href="#cluster-environments">Cluster Environments</a></h2>
<p>Rook 문서는 프로덕션 환경에서 Rook 을 시작하는 것에 초점을 맞추고 있습니다. 
물론 테스트 환겨을 위한 예제들도 제공하고 있으며, 가이드 외에 다른 환경에 클러스터를 구축하길 원한다면, 아래 예제 클러스터 manifest 들을 참고하세요.</p>
<ul>
<li><a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/cluster.yaml">cluster.yaml</a>: 베어메탈, 프로덕션 클러스터에서 설정. 적어도 세개의 워커 노드가 있어야 합니다.</li>
<li><a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/cluster-on-pvc.yaml">cluster-on-pvc.yaml</a>: 여러 클라우드 환경에서 프로덕션 클러스터를 설치하기 위한 설정</li>
<li><a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/cluster-test.yaml">cluster-test.yaml</a>: minikube 와 같은 테스트 환경에서 설치하기 위한 설정</li>
</ul>
<p>더 자세한 정보는 <a href="/ceph_storage/examples.html">Ceph examples</a> 를 참고하세요.</p>
<h2 id="create-a-ceph-cluster"><a class="header" href="#create-a-ceph-cluster">Create a Ceph Cluster</a></h2>
<p>이제 Rook operator 가 클러스터에 설치되고, Ceph 클러스터를 만들 수 있게 되었습니다. 클러스터가 리부팅으로부터 온전하기 위해서, <code>dataDirHostPath</code> 프로퍼티가 호스트에서 잘 설정되어 있는지 확인하세요. 더 많은 설정은, <a href="/ceph_storage/cluster_crd.html">configuring the cluster</a> 를 참고하세요.</p>
<p>Ceph 클러스터를 생성합니다.</p>
<pre><code class="language-sh">kubectl create -f cluster.yaml
</code></pre>
<p><code>rook-ceph</code> 네임스페이스에 Pod 리스트를 확인하기 위해서 <code>kubectl</code> 커맨드를 사용하세요. 모든 Pod 들이 Running 상태라면 아래와 같은 결과를 확인할 수 있습니다. osd pod 들의 갯수는 클러스터 내의 노드와 디바이스 갯수에 따라 다릅니다. <code>cluster.yaml</code> 파일을 수정하지 않았다면, OSD 는 노드의 갯수만큼 만들어집니다. </p>
<blockquote>
<p>만약 <code>rook-ceph-mon</code>, <code>rook-ceph-mgr</code>, <code>rook-ceph-osd</code> pod 이 생성되지 않았다면, <a href="/ceph_tools/common_issues.html">Ceph common issues</a> 을 확인하세요.</p>
</blockquote>
<pre><code class="language-sh">kubectl -n rook-ceph get pod
</code></pre>
<pre><code class="language-sh">NAME                                                 READY   STATUS      RESTARTS   AGE
csi-cephfsplugin-provisioner-d77bb49c6-n5tgs         5/5     Running     0          140s
csi-cephfsplugin-provisioner-d77bb49c6-v9rvn         5/5     Running     0          140s
csi-cephfsplugin-rthrp                               3/3     Running     0          140s
csi-rbdplugin-hbsm7                                  3/3     Running     0          140s
csi-rbdplugin-provisioner-5b5cd64fd-nvk6c            6/6     Running     0          140s
csi-rbdplugin-provisioner-5b5cd64fd-q7bxl            6/6     Running     0          140s
rook-ceph-crashcollector-minikube-5b57b7c5d4-hfldl   1/1     Running     0          105s
rook-ceph-mgr-a-64cd7cdf54-j8b5p                     1/1     Running     0          77s
rook-ceph-mon-a-694bb7987d-fp9w7                     1/1     Running     0          105s
rook-ceph-mon-b-856fdd5cb9-5h2qk                     1/1     Running     0          94s
rook-ceph-mon-c-57545897fc-j576h                     1/1     Running     0          85s
rook-ceph-operator-85f5b946bd-s8grz                  1/1     Running     0          92m
rook-ceph-osd-0-6bb747b6c5-lnvb6                     1/1     Running     0          23s
rook-ceph-osd-1-7f67f9646d-44p7v                     1/1     Running     0          24s
rook-ceph-osd-2-6cd4b776ff-v4d68                     1/1     Running     0          25s
rook-ceph-osd-prepare-node1-vx2rz                    0/2     Completed   0          60s
rook-ceph-osd-prepare-node2-ab3fd                    0/2     Completed   0          60s
rook-ceph-osd-prepare-node3-w4xyz                    0/2     Completed   0          60s
</code></pre>
<p>클러스터가 healty 상태임이 확인되면, <a href="/ceph_tools/toolbox.html">Rook tollbox</a> 에 연결하여 <code>ceph status</code> 커맨드를 입력합니다.</p>
<ul>
<li>모든 mon 들이 quorum 내에 존재함</li>
<li>mgr 이 active 상태</li>
<li>하나 이상의 OSD 가 active 상태</li>
<li>health 가 <code>HEALTH_OK</code> 상태가 아니라면, warning 혹은 error 가 나타납니다.</li>
</ul>
<pre><code class="language-sh">ceph status
</code></pre>
<pre><code class="language-sh"> cluster:
   id:     a0452c76-30d9-4c1a-a948-5d8405f19a7c
   health: HEALTH_OK

 services:
   mon: 3 daemons, quorum a,b,c (age 3m)
   mgr: a(active, since 2m)
   osd: 3 osds: 3 up (since 1m), 3 in (since 1m)
...
</code></pre>
<p>클러스터가 healty 상태가 아니라면, <a href="/ceph_tools/common_issues.html">Ceph common issues</a> 를 참고하세요.</p>
<h2 id="storage"><a class="header" href="#storage">Storage</a></h2>
<p>Rook 에 의해서 세 타입의 스토리지를 사용할 수 있습니다. 각각의 가이드 링크를 참고하세요.</p>
<ul>
<li><a href="/ceph_storage/block_storage.html">Block</a>: Pod 에 의해 사용되는 블록 스토리지를 생성합니다. (RWO)</li>
<li><a href="/ceph_storage/shared_filesystem.html">Shared Filesystem</a>: 여러 Pod 에 걸쳐 공유되는 파일시스템을 생성합니다. (RWX)</li>
<li><a href="/ceph_storage/object_storage.html">Object</a>: 쿠버네티스 클러스터 안밖에서 사용가능한 오브젝트 스토어를 만듭니다.</li>
</ul>
<h2 id="ceph-dashboard"><a class="header" href="#ceph-dashboard">Ceph Dashboard</a></h2>
<p>Ceph 은 클러스터 상태를 확인할 수 있는 대시보드를 제공합니다. <a href="/ceph_storage/ceph_dashboard.html">dashboard guide</a> 를 참고하세요.</p>
<h2 id="tools"><a class="header" href="#tools">Tools</a></h2>
<p>toolbox pod 은 Rook 클러스터를 디버깅하고 트러블슈팅 할 수 있는 ceph admin client 권한을 가집니다. 셋업하고 사용하기 위해서 <a href="/ceph_tools/toolbox.html">toolbox documentation</a> 를 참고하세요. 유지보수와 튜닝을 위해서는 <a href="/ceph_tools/advanced_configuration.html">advanced configuration</a> 을 참고하세요.</p>
<h2 id="monitoring"><a class="header" href="#monitoring">Monitoring</a></h2>
<p>Rook 클러스터는 <a href="https://prometheus.io/">Prometheus</a> 를 통해 매트릭을 제공합니다. Rook 클러스터에 모니터링을 세팅하기 위해서는, <a href="/ceph_storage/prometheus_monitoring.html">monitoring guide</a> 를 참고하세요.</p>
<h2 id="teardown"><a class="header" href="#teardown">Teardown</a></h2>
<p>클러스터 테스트가 완료되었다면, 클러스터 클린업을 위해서 <a href="/ceph_storage/cleanup.html">다음의</a> 가이드를 참고하세요.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prerequisite"><a class="header" href="#prerequisite">Prerequisite</a></h1>
<p>Rook 는 최소 버전 조건을 충족하고, 필요한 권한만 부여되어 있다면 어떤 쿠버네티스 클러스터에서도 설치가 가능합니다. (자세한 정보는 아래를 참고하세요.)</p>
<h2 id="minimum-version-1"><a class="header" href="#minimum-version-1">Minimum Version</a></h2>
<p>Ceph operator 를 위해 Kubernetes v1.16 버전 이상이 필요합니다.</p>
<h2 id="ceph-prerequistes"><a class="header" href="#ceph-prerequistes">Ceph Prerequistes</a></h2>
<p>Ceph 스토리지 클러스터를 설정하기 위해, 아래 로컬 스토리지 옵션 중 하나를 충족해야 합니다:</p>
<ul>
<li>Raw 디바이스 (파티션이 없고, 포맷되어있지 않아야함)</li>
<li>Raw 파티션 (포맷되어 있지 않아야 함)</li>
<li>StorageClass 로 PersistentVolume 이 <code>block</code> 모드로 생성 가능해야 함</li>
</ul>
<p>아래 커맨드로 파티션이나 디바이스가 파일시스템으로 포맷되었는지 확인할 수 있습니다.</p>
<pre><code class="language-sh">lsblk -f
</code></pre>
<pre><code class="language-sh">NAME                  FSTYPE      LABEL UUID                                   MOUNTPOINT
vda
└─vda1                LVM2_member       &gt;eSO50t-GkUV-YKTH-WsGq-hNJY-eKNf-3i07IB
 ├─ubuntu--vg-root   ext4              c2366f76-6e21-4f10-a8f3-6776212e2fe4   /
 └─ubuntu--vg-swap_1 swap              9492a3dc-ad75-47cd-9596-678e8cf17ff9   [SWAP]
vdb
</code></pre>
<p><code>FSTYPE</code> 필드가 비어있지 않다면, 해당 디바이스에 파일시스템이 존재하는 것입니다. 위 예제에서는 <code>vdb</code> 를 사용할 수 있지만, <code>vda</code> 는 사용할 수 없습니다.</p>
<h2 id="lvm-package"><a class="header" href="#lvm-package">LVM package</a></h2>
<p>Ceph OSD 는 아래 시나리오에서 LVM 에 디펜던시를 가지고 있습니다.</p>
<ul>
<li>OSD 가 raw 디바이스나 파티션에 생성될 때</li>
<li>암호화 옵션이 켜져 있을 때 (cluster 커스텀 리소스의 <code>encryptedDevice: true</code>)</li>
<li><code>metadata</code> 디바이스가 지정되어 있을 때</li>
</ul>
<p>다음과 같은 상황에서는 LVM 이 필요하지 않습니다.</p>
<ul>
<li><code>storageClassDeviceSets</code> 를 사용해 PVC 위에 OSD 를 생성할 떄</li>
</ul>
<p>여러분의 시나리오에서 LVM 이 필요하다면, OSD 가 실행될 호스트에서 LVM 이 설치되어 있어야 합니다. 
몇몇 리눅스 배포판에서는 <code>lvm2</code> 패키지가 설치되어 있지 않습니다. LVM 패키지 없이는, 노드가 재시작 될 때 OSD Pod 이 정상적으로 시작되지 않습니다. 
리눅스 배포판의 패키지 매니저로 LVM 패키지 설치가 권장됩니다.</p>
<p>CentOS:</p>
<pre><code class="language-sh">sudo yum install -y lvm2
</code></pre>
<p>Ubuntu:</p>
<pre><code class="language-sh">sudo apt-get install -y lvm2
</code></pre>
<p>RancherOS:</p>
<ul>
<li><a href="https://github.com/rancher/os/issues/2551">1.5.0</a> 부터 LVM 이 지원됩니다.</li>
<li>논리적인 볼륨은 부팅 프로세스에서는 <a href="https://github.com/rook/rook/issues/5027">활성화되지 않습니다.</a>. 가능하게 하기 위해서는 <a href="https://rancher.com/docs/os/v1.x/en/installation/configuration/running-commands/">runcmd command</a> 를 추가해야 합니다.</li>
</ul>
<pre><code class="language-yaml">runcmd:
- [ vgchange, -ay ]
</code></pre>
<h2 id="kernel"><a class="header" href="#kernel">Kernel</a></h2>
<h3 id="rbd"><a class="header" href="#rbd">RBD</a></h3>
<p>Ceph 은 RBD 모듈이 포함된 리눅스 커널이 필요합니다. 대부분의 리눅스 배포판에는 이 모듈이 포함되어 있지만, 아닌 배포판도 존재합니다. (GKE Container-Optimised OS)</p>
<p>쿠버네티스 노드에서 <code>modeprobe rbd</code> 커맨드로 확인이 가능합니다. 만약 'not found' 라고 나온다면, 다른 리눅스 배포판으로 커널을 다시 빌드해야 합니다.</p>
<h3 id="cephfs"><a class="header" href="#cephfs">Cephfs</a></h3>
<p>Ceph shared filesystem (Cephfs) 볼륨을 만들고자 한다면, 4.17 이상의 커널 버전이 권장됩니다. 커널 버전이 4.17 미만이라면, 요청된 PVC 사이즈 쿼타가 정상적으로 제한되지 않습니다.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="authenticated-registries"><a class="header" href="#authenticated-registries">Authenticated Registries</a></h1>
<blockquote>
<p><a href="https://rook.io/docs/rook/v1.8/authenticated-registry.html">생략</a></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pod-security-policies"><a class="header" href="#pod-security-policies">Pod Security Policies</a></h1>
<blockquote>
<p><a href="https://rook.io/docs/rook/v1.8/pod-security-policies.html">생략</a></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ceph-storage"><a class="header" href="#ceph-storage">Ceph Storage</a></h1>
<p>Ceph 은 <strong>블록 스토리지</strong>, <strong>오브젝트 스토리지</strong>, 그리고 <strong>공유 파일시스템</strong> 을 지원하는 수년간 프로덕션 환경에서 사용된 확장성있는 분산 스토리지 솔루션입니다.</p>
<h2 id="design"><a class="header" href="#design">Design</a></h2>
<p>Rook 은 쿠버네티스의 요소들을 사용해서 Ceph 스토리지를 쿠버네티스 클러스터에서 동작하게 만들어 줍니다. 쿠버네티스 위에서 Ceph 이 동작함과 동시에, 쿠버네티스의 어플리케이션들은 Rook 에 의해 관리되는 블록 디바이스나 파일시스템을 마운트하여 사용할 수 있습니다. 또한, S3/Swift API 를 통해 오브젝트 스토리지를 사용할수도 있습니다. Rook 오퍼레이터는 스토리지가 정상적인 상태로 유지되도록 모니터링하고 스토리지 컴포넌트들을 설정합니다.</p>
<p>Rok 오퍼레이터는 스토리지 클러스터를 부트스트랩하고 모니터링 할 수 있는 모든 요소들을 갖춘 단순한 컨테이너입니다. 이 오퍼레이터는 <a href="ceph_storage//ceph_tools/monitor_health.html">Ceph monitor pod</a>과 OSD 데몬, 다른 Ceph 데몬들을 시작하고 모니터링합니다. 또한 서비스를 실행시키는데 필요한 리소스들과 Pod 을 초기화하고 Pool, 오브젝트 스토어, 파일시스템을 위한 CRD 를 관리합니다.</p>
<p>오퍼레이터는 클러스터가 정상적인 상태가 되도록 모니터링 합니다. Ceph mon 들이 오퍼레이터에 의해 시작되거나, 필요에 따라 failover 되며, 클러스터가 커지거나 작아질 때마다 조정이 이루어집니다. 또한 커스텀 리소스의 변경 사항을 보고 변경 사항을 조정하기도 합니다.</p>
<p>Rook 은 여러분의 Pod 에 스토리지를 마운트하기 위해서 자동으로 Ceph-CSI driver 를 설정합니다.</p>
<p><img src="ceph_storage/ceph_storage_01.png" alt="ceph_storage_01" /></p>
<p><code>rook/ceph</code> 이미지는 클러스터를 관리하기 위한 모든 필요한 툴들이 포함되어 있습니다. placement group, crush map 같은 많은 Ceph 의 컨셉들은 숨겨져 있으며, 걱정할 필요가 없습니다. 대신에 Rook 은 물리적인 리소스, pool, volume, filesystem, bucket 에 대한 심플한 사용자 경험을 제공하빈다. 동시에, Ceph tool 을 통해 advanced 한 설정들을 적용할 수 도 있습니다.</p>
<p>Rook 은 golang 으로 개발되었고, Ceph 은 C++ 로 개발되었습니다. 우리는 이 조합이 최고를 제공한다고 믿습니다.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="admission-controller"><a class="header" href="#admission-controller">Admission Controller</a></h1>
<p>어드미션 컨트롤러는 쿠버네티스 리소스가 실제 반영되기 전 요청을 가로채어 인증 및 인가를 확인합니다.</p>
<p>Rook 이 커스텀 리소스 세팅과 함께 올바르게 설정되었는지 확인하기 위해 Rook 어드미션 컨트롤러를 활성화가 권장됩니다.</p>
<h2 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h2>
<p>Rook 어드미션 컨트롤러를 배포하기 위해서, 설정을 자동화 하기 위한 헬퍼 스크립트를 제공합니다.</p>
<p>이 스크립트는 다음과 같은 작업을 하도록 돕습니다.</p>
<ul>
<li>cert-manager 를 사용해 certificate 를 생성</li>
<li>클러스터로부터 적절한 CA 번들로 ValidatingWebhookConfig 를 채워 생성</li>
</ul>
<p>아래 커맨드를 실행합니다.</p>
<pre><code class="language-sh">kubectl create -f deploy/examples/crds.yaml -f deploy/examples/common.yaml
tests/scripts/deploy_admission_controller.sh
</code></pre>
<p>Secret 이 배포되고 나면, operator 를 배포합니다.</p>
<pre><code class="language-sh">kubectl create -f deploy/examples/operator.yaml
</code></pre>
<p>완료되면, 오퍼레이터는 어드미션 컨트롤러 Deployment 를 자동으로 싱행하고, Rook 리소스에 대한 요청을 Webhook 이 인터셉트 하기 시작합니다.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="examples"><a class="header" href="#examples">Examples</a></h1>
<p>블록 디바이스, 공유 파일시스템, 그리고 오브젝트 스토리지를 쿠버네티스 네임스페이스에 제공하기 위해 Rook 과 Ceph 을 설정하는 방법은 다양합니다. 스토리지 셋업을 간단하게 하기 위한 여러가지 예제를 제공했지만, 여러분의 환경에 따라 다양한 튜닝과 설정이 필요할 수 있습니다.</p>
<p>rook/ceph 셋업 스펙 확인을 위해 <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples">example yaml files</a> 를 확인하세요.</p>
<h2 id="common-resources"><a class="header" href="#common-resources">Common Resources</a></h2>
<p>Rook 을 배포하기 위한 첫번째 스텝은 공통 리소스와 CRD 들을 생성하는 것입니다. 이 리소스들을 위한 설정은 대부분의 배포에서 동일합니다. <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/crds.yaml">crds.yaml</a> 과 <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/common.yaml">common.yaml</a> 을 사용합니다.</p>
<pre><code class="language-sh">kubectl create -f crds.yaml -f common.yaml
</code></pre>
<p>위 예제는 오퍼레이터와 Ceph 데몬들이 모두 같은 네임스페이스에 배포되는 것을 가정합니다. 만약 여러분이 다른 네임스페이스 배포를 원한다면, <code>common.yaml</code> 파일의 주석을 확인하세요.</p>
<h2 id="operator"><a class="header" href="#operator">Operator</a></h2>
<p>공통 리소스가 만들어졌다면, 다음 스텝은 오퍼레이터 Deployment 를 만드는 읿입니다. <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/">이 디렉토리</a>에 여러 파일 스펙 예제들이 포함되어 있습니다.</p>
<ul>
<li><code>operator.yaml</code>: 가장 공통된 세팅의 프로덕션 배포
<ul>
<li><code>kubectl create -f operator.yaml</code></li>
</ul>
</li>
<li><code>operator-openshft.yaml</code>: Openshift 환경 배포에 최적화
<ul>
<li><code>oc create -f operator-openshift.yaml</code></li>
</ul>
</li>
</ul>
<p>오퍼레이터를 위한 설정들은 오퍼레이터 Deployment 에 환경변수로 설정됩니다. 각 세팅은 <a href="https://github.com/rook/rook/blob/release-1.8/deploy/examples/operator.yaml">operator.yaml</a> 에 기술되어 있습니다.</p>
<h2 id="cluster-crd"><a class="header" href="#cluster-crd">Cluster CRD</a></h2>
<p>오퍼레이터가 동작하기 시작하면, Ceph 스토리지 클러스터를 만들 수 있습니다. 이 커스텀 리소스는 오퍼레이터가 스토리지를 어떻게 운영할 것인지에 대한 크리티컬한 설정들이 포함됩니다. 클러스터를 설정하기 위한 여러가지 방법들을 충분히 이해하는 것이 중요합니다. 아래 예제들은 스토리지를 구성하기 위한 간단한 방법들을 보여줍니다.</p>
<ul>
<li><code>cluster.yaml</code>: 프로덕선 스토리지 클러스터의 공통 설정을 포함합니다. 적어도 세개 이상의 워커 노드가 필요합니다.</li>
<li><code>cluster-test.yaml</code>: 오직 하나의 노드만 필요한 테스트용 클러스터 설정입니다.</li>
<li><code>cluster-on-pvc.yaml</code>: Ceph mon 과 osd 들을 PV 로 사용하는 설정을 포함하고 있습니다. 클라우드 환겨이나 local PV 가 만들어져 있는 환경에 적합합니다.</li>
<li><code>cluster-external.yaml</code>: 외부 Ceph 클러스터를 연결하기 위한 설정입니다.</li>
<li><code>cluster-external-management.yaml</code>: 어드민 키를 사용해 원격으로 pool 을 만들고 오브젝트 스토어, 공유 파일시스템 등을 설정할 수 있는 설정입니다.</li>
<li><code>cluster-stretched.yaml</code>: 클러스터를 &quot;stretched&quot; 모들 생성할 수 있는 설정입니다. 세 개의 존에 5개의 노드, 그리고 두개의 존에 OSD 가 펼쳐집니다. <a href="ceph_storage//ceph_storage/cluster_crd.html#stretch-cluster">Stretch documentation</a> 문서를 참고하세요.</li>
</ul>
<p>더 많은 정보는 <a href="ceph_storage//ceph_storage/cluster_crd.html">Cluster CRD</a> 를 참고하세요.</p>
<h2 id="setting-up-consumable-storage"><a class="header" href="#setting-up-consumable-storage">Setting up consumable storage</a></h2>
<p>이제 Rook Ceph 클러스터 내에 블록, 오브젝트 스토리지 및 공유 파일 시스템이 사용 가능한 상태가 되었습니다. 이 스토리지들은 각각 CephBlockPool, CephFilesystem, CephObjectStore 리소스로 참조됩니다.</p>
<h3 id="block-devices"><a class="header" href="#block-devices">Block Devices</a></h3>
<p>Ceph 은 pod 에 raw 블록 디바이스를 제공할 수 있습니다. 아래의 각 예제들은 쿠버네티스 pod 에 블록 디바이스를 제공하는 storage class 를 셋업합니다. 이 storage class 는 <a href="http://docs.ceph.com/docs/master/rados/operations/pools/">pool</a>과 함께 저장 방식에 따라 정의됩니다.</p>
<ul>
<li><code>storageclass.yaml</code>: 이 예제는 3개의 레플리케이션을 가진 프로덕션 시나리오에서 사용되며, 적어도 세개의 워커 노드를 필요로 합니다. 쿠버네티스의 세 워커 노드에 레플리케이션되어 하나의 노드가 죽어도 데이터에 손실이 생기지 않습니다.</li>
<li><code>storageclass-ec.yaml</code>: Erasure coding 방식으로 설정합니다. Erasure coding 방식은 레플리케이션 방식보다 더 적은 데이터 공간을 차지하지만, 더 많은 컴퓨팅 파워를 요구합니다. 마찬가지로 적어도 세개의 워커 노드가 필요합니다. 문서를 참고하세요.</li>
<li><code>storageclass-test.yaml</code>: 1개의 레플리케이션을 요구하는 테스트용 시나리오를 위해 사용됩니다. 한개의 노드가 죽으면 데이터 손실로 이어지므로 프로덕션 레벨에서 사용해서는 안됩니다.</li>
</ul>
<p>storage class 는 드라이버에 따라 다른 서브디렉토리에 존재합니다.</p>
<ul>
<li><code>csi/rbd</code>: 블록 디바이스를 위한 CSI Driver 입니다. </li>
</ul>
<p>더 많은 정보는 <a href="ceph_storage//ceph_storage/block_pool_crd.html">Ceph Pool CRD</a> 문서를 참고하세요.</p>
<h3 id="shared-filesystem"><a class="header" href="#shared-filesystem">Shared Filesystem</a></h3>
<p>Ceph 파일시스템 (Cephfs) 는 하나 이상의 호스트(Pod)에 POSIX 호환의 폴더 마운트를 가능하게 해줍니다. NFS 나 CIFS 와 비슷합니다.</p>
<p>파일 스토리지는 여러 pool 을 포함하며, 여러 시나리오에서 아래 파일들을 사용합니다.</p>
<ul>
<li><code>filesystem.yaml</code>: 프로덕션 시나리오를 위한 3개의 레플리케이션, 세개 이상의 노드가 필요함</li>
<li><code>filesystem-ec.yaml</code>: 프로덕션 시나리오를 위한 Erasure coding, 세개 이상의 노드가 필요함</li>
<li><code>filesystem-test.yaml</code>: 테스트 시나리오를 위한 1개의 레플리케이션, 한개 노드가 필요</li>
</ul>
<p>CSI Driver 를 통해 다이나믹 프로비저닝이 가능합니다. 공유 파일시스템을 위한 storage class 는 <code>csi/cephfs</code> 디렉토리에 있습니다.</p>
<p><a href="ceph_storage//ceph_storage/shared_filesstem_crd.html">Shared Filesystem CRD</a> 문서를 참고하세요.</p>
<h3 id="object-storage"><a class="header" href="#object-storage">Object Storage</a></h3>
<p>Ceph 은 HTTP(s)-type 로 get/put/post/delete 오퍼레이션을 수행할 수 있는 오브젝트 스토리지를 제공합니다. AWS S3 스토리지와 비슷합니다.</p>
<p>오브젝트 스토리지는 여러 pool 을 포함하며, 여러 시나리오에서 각각 아래 예제 파일들을 사용할 수 있습니다.</p>
<ul>
<li><code>object.yaml</code>: 프로덕션을 위한 3개의 레플리케이션, 세개 이상의 노드 필요</li>
<li><code>object-openshift.yaml</code>: Openshift 환경을 위한 3개의 레플리케이션, 세개 이상의 노드 필요</li>
<li><code>object-ec.yaml</code>: 프로덕션을 위한 Erasure coding, 세개 이상의 노드 필요</li>
<li><code>object-test.yaml</code>: 테스트 환경을 위한 1개 레플리케이션, 한개 노드 필요</li>
</ul>
<p><a href="ceph_storage//ceph_storage/object_store_crd.html">Object Store CRD</a> 문서를 참고하세요.</p>
<h3 id="object-storage-user"><a class="header" href="#object-storage-user">Object Storage User</a></h3>
<ul>
<li><code>object-user.yaml</code>: 오브젝트 스토리지 유저를 생성하고, S3 API 를 위한 인증 정보를 생성합니다.</li>
</ul>
<h3 id="object-storage-bucket"><a class="header" href="#object-storage-bucket">Object Storage Bucket</a></h3>
<p>또한 Ceph 오퍼레이터는 기 존재하는 버킷에 권한을 부여하거나 신규 버킷을 다이나믹하게 생성할 수 있는 object store bucket provisioner 를 실행합니다.</p>
<ul>
<li><code>object-bucket-claim-retain.yaml</code>: Retain 상태로 StorageClass 를 참조하는 신규 버킷 요청을 생성합니다.</li>
<li><code>object-bucket-claim-delete.yaml</code>: Delete 상태로 StorageClass 를 참조하는 신규 버킷 요청을 생성합니다.</li>
<li><code>storageclass-bucket-retain.yaml</code>: Retain 상태로 Ceph 오브젝트 스토어, 리전을 정의하는 StorageClass 를 생성합니다.</li>
<li><code>storageclass-bucket-delete.yaml</code>: Delete 상태로 Ceph 오브젝트 스토어, 리전을 정의하는 StorageClass 를 생성합니다.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="openshift"><a class="header" href="#openshift">Openshift</a></h1>
<blockquote>
<p><a href="https://rook.io/docs/rook/v1.8/ceph-openshift.html">생략</a></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="block-storage"><a class="header" href="#block-storage">Block Storage</a></h1>
<p>블록 스토리지는 단일 Pod 에 스토리지 마운트를 지원합니다. 이 가이드는 Rook 으로 활성화된 PersistentVolume 을 어떻게 만들고 구성하는지 보여줍니다. </p>
<h2 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h2>
<p><a href="ceph_storage//quickstart.html">Quickstart</a> 가이드에 따라 Rook 클러스터가 구축된 상황을 가정합니다.</p>
<h2 id="provision-storage"><a class="header" href="#provision-storage">Provision Storage</a></h2>
<p>Rook 이 스토리지를 프로비저닝 하기 전에, <code>StorageClass</code> 와 <code>CephBlockPool</code> 커스텀 리소스가 생성되어 있어야 합니다. 이렇게 하면 PersistentVolume 을 프로비저닝 할 때 쿠버네티스가 Rook 과 상호작용 할 수 있습니다.</p>
<blockquote>
<p><strong>NOTE</strong>: 예제는 세개의 다른 노드에 있는 OSD 와 함께 노드당 적어도 1개 이상의 OSD 가 필요합니다. </p>
</blockquote>
<p>아래의 <code>stoargeclass.yaml</code> 에 정의되어 있는 <code>StorageClass</code> 를 저장합니다. </p>
<pre><code class="language-yaml">apiVersion: ceph.rook.io/v1
kind: CephBlockPool
metadata:
  name: replicapool
  namespace: rook-ceph
spec:
  failureDomain: host
  replicated:
    size: 3
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
   name: rook-ceph-block
# Change &quot;rook-ceph&quot; provisioner prefix to match the operator namespace if needed
provisioner: rook-ceph.rbd.csi.ceph.com
parameters:
    # clusterID is the namespace where the rook cluster is running
    clusterID: rook-ceph
    # Ceph pool into which the RBD image shall be created
    pool: replicapool

    # (optional) mapOptions is a comma-separated list of map options.
    # For krbd options refer
    # https://docs.ceph.com/docs/master/man/8/rbd/#kernel-rbd-krbd-options
    # For nbd options refer
    # https://docs.ceph.com/docs/master/man/8/rbd-nbd/#options
    # mapOptions: lock_on_read,queue_depth=1024

    # (optional) unmapOptions is a comma-separated list of unmap options.
    # For krbd options refer
    # https://docs.ceph.com/docs/master/man/8/rbd/#kernel-rbd-krbd-options
    # For nbd options refer
    # https://docs.ceph.com/docs/master/man/8/rbd-nbd/#options
    # unmapOptions: force

    # RBD image format. Defaults to &quot;2&quot;.
    imageFormat: &quot;2&quot;

    # RBD image features. Available for imageFormat: &quot;2&quot;. CSI RBD currently supports only `layering` feature.
    imageFeatures: layering

    # The secrets contain Ceph admin credentials.
    csi.storage.k8s.io/provisioner-secret-name: rook-csi-rbd-provisioner
    csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph
    csi.storage.k8s.io/controller-expand-secret-name: rook-csi-rbd-provisioner
    csi.storage.k8s.io/controller-expand-secret-namespace: rook-ceph
    csi.storage.k8s.io/node-stage-secret-name: rook-csi-rbd-node
    csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph

    # Specify the filesystem type of the volume. If not specified, csi-provisioner
    # will set default as `ext4`. Note that `xfs` is not recommended due to potential deadlock
    # in hyperconverged settings where the volume is mounted on the same node as the osds.
    csi.storage.k8s.io/fstype: ext4

# Delete the rbd volume when a PVC is deleted
reclaimPolicy: Delete

# Optional, if you want to add dynamic resize for PVC. Works for Kubernetes 1.14+
# For now only ext3, ext4, xfs resize support provided, like in Kubernetes itself.
allowVolumeExpansion: true
</code></pre>
<p>&quot;rook-ceph&quot; 외에 다른 네임스페이스에 Rook 오퍼레이터를 배포했다면, 프로비저너의 프리픽스를 해당 네임스페이스로 변경해야 합니다. 예를 들어, Rook 오퍼레이터가 설치된 네임스페이스가 &quot;my-namespace&quot; 라면 프로비저너 스펙은 &quot;my-namespace.rbd.csi.ceph.com&quot; 이 됩니다.</p>
<p>storage class 를 생성합니다.</p>
<pre><code class="language-sh">kubectl create -f deploy/examples/csi/rbd/storageclass.yaml
</code></pre>
<blockquote>
<p><strong>NOTE</strong>: <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#retain">쿠버네티스 문서</a> 에서 언급되었다시피, <code>Retain</code> reclaim policy 를 사용하게 되면, <code>PersistentVolume</code> 이 삭제되더라도 Ceph RBD 볼륨은 삭제되지 않습니다. <code>rbd rm</code> 을 통해 클린업이 필요합니다.</p>
</blockquote>
<h2 id="consume-the-storage-wordpress-sample"><a class="header" href="#consume-the-storage-wordpress-sample">Consume the storage: Wordpress sample</a></h2>
<p>Rook 에 의해 프로비저닝 된 블록 스토리지를 사용하여 wordpress 와 mysql 어플리케이션을 생성합니다. 
두 어플리케이션은 Rook 으로 프로비저닝 된 블록 볼륨을 사용합니다.</p>
<p><code>deploy/examples</code> 폴더 내의 mysql 과 wordpress 를 배포합니다.</p>
<pre><code class="language-sh">kubectl create -f mysql.yaml
kubectl create -f wordpress.yaml
</code></pre>
<p>두 어플리케이션은 각각 블록 볼륨을 마운트하며, 아래 커맨드로 쿠버네티스 PersistentVolumeClaim 이 생성된 것을 확인할 수 있습니다.</p>
<pre><code class="language-sh">kubectl get pvc
</code></pre>
<pre><code class="language-sh">NAME             STATUS    VOLUME                                     CAPACITY   ACCESSMODES   AGE
mysql-pv-claim   Bound     pvc-95402dbc-efc0-11e6-bc9a-0cc47a3459ee   20Gi       RWO           1m
wp-pv-claim      Bound     pvc-39e43169-efc1-11e6-bc9a-0cc47a3459ee   20Gi       RWO           1m
</code></pre>
<p>두 Pod 이 <code>Running</code> 상태가 되면, 여러분의 브라우저에서 접근할 포트를 확인합니다.</p>
<pre><code class="language-sh">kubectl get svc wordpress
</code></pre>
<pre><code class="language-sh">NAME        CLUSTER-IP   EXTERNAL-IP   PORT(S)        AGE
wordpress   10.3.0.155   &lt;pending&gt;     80:30841/TCP   2m
</code></pre>
<p>이제 wordpress 어플리케이션이 실행하는 것을 확인할 수 있습니다.
minikube 를 사용한다면, 아래 커맨드로 wordpress URL 을 확인할 수 있습니다.</p>
<pre><code class="language-sh">echo http://$(minikube ip):$(kubectl get service wordpress -o jsonpath='{.spec.ports[0].nodePort}')
</code></pre>
<blockquote>
<p><strong>NOTE</strong>: vagrant 환경에서 실행한다면, wordpress 어플리케이션을 확인할 external ip 가 존재하지 않습니다. 쿠버네티스 클러스터 안에서 <code>CLUSTER-IP</code> 를 통해서만 wordpress 에 접근할 수 있습니다.</p>
</blockquote>
<h2 id="consume-the-storage-toolbox"><a class="header" href="#consume-the-storage-toolbox">Consume the storage: Toolbox</a></h2>
<p>위에서 만든 pool 로, 블록 이미지를 만들고 pod 에 직접적으로 마운트 할 수 있습니다. <a href="ceph_storage//ceph_tools/direct_tools.html">Direct Block Tools</a> 를 참고하세요.</p>
<h2 id="teardown-1"><a class="header" href="#teardown-1">Teardown</a></h2>
<p>위 데모에서 생성한 모든 리소스를 삭제하려면 아래 커맨드를 입력합니다.</p>
<pre><code class="language-sh">kubectl delete -f wordpress.yaml
kubectl delete -f mysql.yaml
kubectl delete -n rook-ceph cephblockpools.ceph.rook.io replicapool
kubectl delete storageclass rook-ceph-block
</code></pre>
<h2 id="advanced-example-erasure-coded-block-storage"><a class="header" href="#advanced-example-erasure-coded-block-storage">Advanced Example: Erasure Coded Block Storage</a></h2>
<p>RBD 를 erasure code pool 로 사용하고 싶다면, OSD 의 <code>storageType</code> 이 <code>bluestore</code> 로 설정되어 있어야 합니다. 또한 마운트가 가능하려면 커널이 <code>4.11</code> 이상이어야 합니다.</p>
<p><strong>NOTE</strong>: 예제는 세 개 이상의 OSD 가 필요하며, 각 OSD 는 서로 다른 노드에 존재해야 합니다.</p>
<p>OSD 는 <code>failureDomain</code> 이 <code>host</code> 로 설정되어 있고, <code>erasureCoded</code> 청크 설정이 적어도 세 개의 다른 OSD (2 <code>dataChunks</code> + 1 <code>codingChunks</code>) 가 필요하기 문에, OSD 는 서로 다른 노드에 존재하고 있어야 합니다.</p>
<p>erasure coded pool 의 사용을 위해서는 두개의 pool 을 생성해야 합니다.</p>
<h3 id="erasure-coded-csi-driver"><a class="header" href="#erasure-coded-csi-driver">Erasure Coded CSI Driver</a></h3>
<p>Erasure coded pool 을 사용하려면 <code>storageclass-ec.yaml</code> 에 <code>dataPool</code> 파라미터가 설정되어 있어야 합니다. RBD 이미지의 데이터로 사용됩니다.</p>
<h3 id="erasure-coded-flex-driver"><a class="header" href="#erasure-coded-flex-driver">Erasure Coded Flex Driver</a></h3>
<p>Erasure coded pool 을 사용하려면 <code>storageclass-ec.yaml</code> 에 <code>dataBlockPool</code> 파라미터가 설정되어 있어야 합니다. RBD 이미지의 데이터로 사용됩니다.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="object-storage-1"><a class="header" href="#object-storage-1">Object Storage</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shared-filesystem-1"><a class="header" href="#shared-filesystem-1">Shared Filesystem</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ceph-dashboard-1"><a class="header" href="#ceph-dashboard-1">Ceph Dashboard</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prometheus-monitoring"><a class="header" href="#prometheus-monitoring">Prometheus Monitoring</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cluster-crd-1"><a class="header" href="#cluster-crd-1">Cluster CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="block-pool-crd"><a class="header" href="#block-pool-crd">Block Pool CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="object-store-crd"><a class="header" href="#object-store-crd">Object Store CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="object-multisite-crds"><a class="header" href="#object-multisite-crds">Object Multisite CRDs</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="object-bucket-claim"><a class="header" href="#object-bucket-claim">Object Bucket Claim</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="object-store-user-crd"><a class="header" href="#object-store-user-crd">Object Store User CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bucket-notifications"><a class="header" href="#bucket-notifications">Bucket Notifications</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shared-filesystem-crd"><a class="header" href="#shared-filesystem-crd">Shared Filesystem CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nfs-crd"><a class="header" href="#nfs-crd">NFS CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ceph-csi"><a class="header" href="#ceph-csi">Ceph CSI</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rbd-mirroring"><a class="header" href="#rbd-mirroring">RBD Mirroring</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="failover-and-failback"><a class="header" href="#failover-and-failback">Failover and Failback</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="snapshots"><a class="header" href="#snapshots">Snapshots</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="volume-clone"><a class="header" href="#volume-clone">Volume clone</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-crd"><a class="header" href="#client-crd">Client CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rbdmirror-crd"><a class="header" href="#rbdmirror-crd">RBDMirror CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="filesystemmirror-crd"><a class="header" href="#filesystemmirror-crd">FilesystemMirror CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subvolumegroup-crd"><a class="header" href="#subvolumegroup-crd">SubVolumeGroup CRD</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="key-management-system"><a class="header" href="#key-management-system">Key Management System</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="upgrades"><a class="header" href="#upgrades">Upgrades</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cleanup"><a class="header" href="#cleanup">Cleanup</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="helm-charts"><a class="header" href="#helm-charts">Helm Charts</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ceph-operator"><a class="header" href="#ceph-operator">Ceph Operator</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ceph-cluster"><a class="header" href="#ceph-cluster">Ceph Cluster</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="common-issues"><a class="header" href="#common-issues">Common Issues</a></h1>
<p>Rook 클러스터를 운영하면서 트러블슈팅을 돕기 위한 몇몇 팁들입니다. 이 페이지에서 찾은 해결방안으로 시도해도 문제가 해결되지 않은 경우, <a href="https://slack.rook.io/">Rook Slack 가입</a> 후 General 채널에서 도움을 요청하세요. </p>
<h2 id="ceph"><a class="header" href="#ceph">Ceph</a></h2>
<p>Ceph 에 관련된 이슈들은 <a href="/ceph_tools/common_issues.html">Ceph Common Issues</a> 페이지를 참고하세요.</p>
<h2 id="troubleshooting-techniques"><a class="header" href="#troubleshooting-techniques">Troubleshooting Techniques</a></h2>
<p>쿠버네티스 상태와 로그는 Rook 클러스터 이슈를 확인하는데 필요한 중요 리소스입니다.</p>
<h2 id="kubernetes-tools"><a class="header" href="#kubernetes-tools">Kubernetes Tools</a></h2>
<p>쿠버네티스 상태는 클러스터가 정상 동작하지 않을 때 가장 처음 확인해야할 리소스입니다. 아래 방법들이 상태를 확인하는데 도움을 줄 수 있습니다.</p>
<ul>
<li>Rook pod status
<ul>
<li><code>kubectl get po -n &lt;cluster-namespace&gt; -o wide</code></li>
</ul>
</li>
<li>Logs for Rook pods
<ul>
<li>오퍼레이터 로그: <code>kubectl logs -n &lt;cluster-namespace&gt; -l app=&lt;storage-backend-operator&gt;</code></li>
<li>특정 Pod 에 대한 로그: <code>kubectl logs -n &lt;cluster-namespace&gt; &lt;pod-name&gt;</code>, 혹은 pod label (ex. mon1) 로 조회: <code>kubectl logs -n &lt;cluster-namespace&gt; -l &lt;label-matcher&gt;</code></li>
<li>PVC 가 왜 마운트에 실패했는지에 대한 로그: 
<ul>
<li>노드에 연결하고, kubelet 로그를 확인합니다: <code>journalctl -u kubelet</code></li>
</ul>
</li>
<li>여러 컨테이너가 동작하는 Pod
<ul>
<li>모든 컨테이너에 대해서: <code>kubectl -n &lt;cluster-namespace&gt; logs &lt;pod-name&gt; --all-containers</code></li>
<li>특정 컨테이너에 대해서: <code>kubectl -n &lt;cluster-namespace&gt; logs &lt;pod-name&gt; -c &lt;container-name&gt;</code></li>
</ul>
</li>
<li>더 이상 running 상태가 아닌 Pod 로그 확인: <code>kubectl -n &lt;cluster-namespace&gt; logs --previous &lt;pod-name&gt;</code></li>
</ul>
</li>
</ul>
<p>몇몇 Pod 들은 initContainers 스펙을 가지고 있으며, pod 내에서 다른 컨테이너의 로그를 확인해야 할 수 도 있습니다.</p>
<ul>
<li><code>kubectl -n &lt;namespace&gt; logs &lt;pod-name&gt; -c &lt;container-name&gt;</code></li>
<li>다른 Rook 컴포넌트들: <code>kubectl -n &lt;cluster-namespace&gt; get all</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ceph-tools"><a class="header" href="#ceph-tools">Ceph Tools</a></h1>
<p>Rook 은 클러스터 운영을 위한 여러 툴들과 트러블슈팅 문서를 제공합니다.</p>
<ul>
<li><a href="ceph_tools/toolbox.html">Toolbox</a>: 스토리지 클러스터의 트러블슈팅을 위한 모든 툴들을 실행할 수 있는 pod</li>
<li><a href="ceph_tools/common_issues.html">Common Issues</a>: 공통 이슈와 해결법</li>
<li><a href="ceph_tools/osd_management.html">OSD Management</a>: 스토리지를 추가하거나 삭제할 때의 Ceph OSD 에 대한 공통 설정 이슈</li>
<li><a href="ceph_tools/direct_tools.html">Direct Tools</a>: 직접 블록 및 파일 스토리지를 마운트하여 테스트 하기 위한 툴</li>
<li><a href="ceph_tools/advanced_configuration.html">Advanced Configuration</a>: 클러스터를 설정하기 위한 팁과 트릭들</li>
<li><a href="ceph_tools/openshift_common_issues.html">Openshift Common Issues</a>: Openshift 클러스터를 위한 트러블슈팅 팁</li>
<li><a href="ceph_tools/disaster_recovery.html">Disaster Recovery</a>: mon 들이 quorum 을 잃어버렸을 때 최악의 시나리오를 위한 recover 스텝</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="toolbox"><a class="header" href="#toolbox">Toolbox</a></h1>
<p>Rook toolbox 는 Rook 의 디버깅과 테스트를 위한 툴 컨테이너입니다. toolbox 는 CentOS 를 기반으로 만들어져 있어, <code>yum</code> 패키지 매니저를 사용하여 손쉽게 추가 패키지 설치가 가능합니다.</p>
<p>toolbox 는 두가지 모드로 실행할 수 있습니다.</p>
<ol>
<li><a href="ceph_tools/toolbox.html#interactive-toolbox">Interactive</a>: Shell 에서 Ceph 에 연결하여 커맨드를 실행할 수 있는 toolbox pod 을 시작합니다.</li>
<li><a href="ceph_tools/toolbox.html#toolbox-job">One-time job</a>: Ceph 커맨드를 실행하여 job 로그를 가져옵니다.</li>
</ol>
<blockquote>
<p>Prerequisite: toolbox 를 실행하기 전에, Rook 클러스터가 배포되어 있어야 합니. (<a href="ceph_tools//quickstart.html">Quickstart Guide</a> 를 참고하세요.)</p>
</blockquote>
<h2 id="interactive-toolbox"><a class="header" href="#interactive-toolbox">Interactive Toolbox</a></h2>
<p>Rook toolbox 는 쿠버네티스 클러스터 안에서 Deployment 로 배포할 수 있으며, Pod 내에서 Ceph 커맨드를 실행할 수 있습니다.</p>
<p>rook-ceph-tools pod 을 배포합니다.</p>
<pre><code class="language-sh">kubectl create -f deploy/examples/toolbox.yaml
</code></pre>
<p>toolbox pod 이 <code>Runinng</code> 상태가 될 때까지 기다립니다.</p>
<pre><code class="language-sh">kubectl -n rook-ceph rollout status deploy/rook-ceph-tools
</code></pre>
<p>rook-ceph-tools 가 <code>Running</code> 상태이면, Pod 에 연결해 커맨드를 실행할 수 있습니다.</p>
<p>*<em>Example</em></p>
<ul>
<li><code>ceph status</code></li>
<li><code>ceph osd status</code></li>
<li><code>ceph df</code></li>
<li><code>rados df</code></li>
</ul>
<p>작업이 끝낫다면, Deployment 를 삭제합니다.</p>
<pre><code class="language-sh">kubectl -n rook-ceph delete deploy/rook-ceph-tools
</code></pre>
<h2 id="toolbox-job"><a class="header" href="#toolbox-job">Toolbox Job</a></h2>
<p>커맨드를 한번만 실행해서 결과를 얻고 싶다면, 쿠버네티스 Job 을 사용할 수 있습니다. toolbox job 은 job 스펙에 명시되어 있는 스크립트를 실행합니다. 스크립트는 Bash 스크립트로 작성합니다.</p>
<p>아래 예제에서, job 이 생성되면 <code>ceph status</code> 커맨드가 실행됩니다.</p>
<pre><code class="language-sh">kubectl create -f deploy/examples/toolbox-job.yaml
</code></pre>
<p>job 이 완료되면, 아래 커맨드로 스크립트의 결과를 화인합니다.</p>
<pre><code class="language-sh">kubectl -n rook-ceph logs -l job-name=rook-ceph-toolbox-job
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="common-issues-1"><a class="header" href="#common-issues-1">Common Issues</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="csi-common-issues"><a class="header" href="#csi-common-issues">CSI Common Issues</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monitor-health"><a class="header" href="#monitor-health">Monitor Health</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="osd-management"><a class="header" href="#osd-management">OSD Management</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="direct-tools"><a class="header" href="#direct-tools">Direct Tools</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="advanced-configuration"><a class="header" href="#advanced-configuration">Advanced Configuration</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="openshift-common-issues"><a class="header" href="#openshift-common-issues">Openshift Common Issues</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="disaster-recovery"><a class="header" href="#disaster-recovery">Disaster Recovery</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
